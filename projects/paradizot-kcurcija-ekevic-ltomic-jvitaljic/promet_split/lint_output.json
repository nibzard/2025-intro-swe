[{"filePath":"C:\\Users\\Lucija\\Desktop\\promet_split\\src\\context\\UserContext.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'setStats' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":50,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"setStats"},"fix":{"range":[1987,1997],"text":""},"desc":"Remove unused variable 'setStats'."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":195,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":195,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useEffect } from 'react';\n\nconst UserContext = createContext();\n\nexport const UserProvider = ({ children }) => {\n    // Initialize state from localStorage if available\n    const [user, setUser] = useState(() => {\n        const saved = localStorage.getItem('user_data');\n        return saved ? JSON.parse(saved) : {\n            name: 'Ivan Horvat',\n            email: 'ivan.horvat@email.com',\n            balance: 15.50\n        };\n    });\n\n    const [notificationSettings, setNotificationSettings] = useState(() => {\n        const saved = localStorage.getItem('user_notification_settings');\n        return saved ? JSON.parse(saved) : {\n            transactions: true,\n            tickets: true,\n            promotions: false,\n            sound: true\n        };\n    });\n\n    const [transactions, setTransactions] = useState(() => {\n        const saved = localStorage.getItem('user_transactions');\n        return saved ? JSON.parse(saved) : [];\n    });\n\n    const [tickets, setTickets] = useState(() => {\n        const saved = localStorage.getItem('user_tickets');\n        return saved ? JSON.parse(saved) : [\n            // Initial mock tickets can go here if needed, or start empty?\n            // Let's keep the mock ones from Tickets.jsx roughly or just start empty/new.\n            // For now let's pre-populate with some \"old\" ones to show it works\n            { id: 1, type: '1 Sat', status: 'active', purchaseDate: new Date().toISOString() },\n            { id: 2, type: '24 Sata', status: 'not_activated', purchaseDate: new Date().toISOString() },\n        ];\n    });\n\n    const [paymentMethods, setPaymentMethods] = useState(() => {\n        const saved = localStorage.getItem('user_payment_methods');\n        return saved ? JSON.parse(saved) : [\n            { id: '1', type: 'card', name: 'Visa **** 1234', default: true },\n            { id: '2', type: 'google', name: 'Google Pay', default: false }\n        ];\n    });\n\n    const [stats, setStats] = useState(() => {\n        const saved = localStorage.getItem('user_stats');\n        return saved ? JSON.parse(saved) : {\n            rides: 42,\n            km: 156,\n            co2: 12.5 // kg\n        };\n    });\n\n    const [savedLocations, setSavedLocations] = useState(() => {\n        const saved = localStorage.getItem('user_saved_locations');\n        return saved ? JSON.parse(saved) : [\n            { id: 1, name: 'KuÄ‡a', address: 'Vukovarska 1' },\n            { id: 2, name: 'Posao', address: 'Domovinskog rata 2' }\n        ];\n    });\n\n    // Persist to localStorage whenever state changes\n    useEffect(() => {\n        localStorage.setItem('user_data', JSON.stringify(user));\n    }, [user]);\n\n    useEffect(() => {\n        localStorage.setItem('user_transactions', JSON.stringify(transactions));\n    }, [transactions]);\n\n    useEffect(() => {\n        localStorage.setItem('user_tickets', JSON.stringify(tickets));\n    }, [tickets]);\n\n    useEffect(() => {\n        localStorage.setItem('user_payment_methods', JSON.stringify(paymentMethods));\n    }, [paymentMethods]);\n\n    useEffect(() => {\n        localStorage.setItem('user_stats', JSON.stringify(stats));\n    }, [stats]);\n\n    useEffect(() => {\n        localStorage.setItem('user_saved_locations', JSON.stringify(savedLocations));\n    }, [savedLocations]);\n\n    useEffect(() => {\n        localStorage.setItem('user_notification_settings', JSON.stringify(notificationSettings));\n    }, [notificationSettings]);\n\n    // Actions\n    const updateUser = (updates) => {\n        setUser(prev => ({ ...prev, ...updates }));\n    };\n\n    const updateNotificationSettings = (key, value) => {\n        setNotificationSettings(prev => ({ ...prev, [key]: value }));\n    };\n\n    // Payment Method Actions\n    const addPaymentMethod = (method) => {\n        setPaymentMethods(prev => [...prev, { ...method, id: Date.now().toString() }]);\n    };\n\n    const removePaymentMethod = (id) => {\n        setPaymentMethods(prev => prev.filter(pm => pm.id !== id));\n    };\n\n    const setDefaultPaymentMethod = (id) => {\n        setPaymentMethods(prev => prev.map(pm => ({\n            ...pm,\n            default: pm.id === id\n        })));\n    };\n\n    const addTransaction = (transaction) => {\n        setTransactions(prev => [\n            { id: Date.now(), ...transaction },\n            ...prev\n        ]);\n    };\n\n    const addLocation = (location) => {\n        setSavedLocations(prev => [...prev, { ...location, id: Date.now() }]);\n    };\n\n    const removeLocation = (id) => {\n        setSavedLocations(prev => prev.filter(l => l.id !== id));\n    };\n    const addToBalance = (amount) => {\n        setUser(prev => ({ ...prev, balance: prev.balance + amount }));\n        addTransaction({\n            type: 'topup',\n            title: 'Nadoplata lisnice',\n            amount: amount,\n            date: new Date().toISOString(),\n            status: 'completed'\n        });\n    };\n\n    const subtractFromBalance = (amount) => {\n        setUser(prev => ({ ...prev, balance: prev.balance - amount }));\n    };\n\n\n\n    const addTicket = (ticket) => {\n        setTickets(prev => [ticket, ...prev]);\n        // Also record transaction\n        const durationInfo = ticket.duration ? `(${ticket.duration})` : '';\n        addTransaction({\n            type: 'purchase',\n            title: `Kupnja karte: ${ticket.type} ${durationInfo}`.trim(),\n            amount: -ticket.price, // Negative for spending\n            date: new Date().toISOString(),\n            status: 'completed'\n        });\n    };\n\n    return (\n        <UserContext.Provider value={{\n            user,\n            setUser,\n            transactions,\n            addTransaction,\n            tickets,\n            setTickets,\n            addTicket, // Helper that handles balance deduction? Or separate?\n            // Let's keep subtractFromBalance separate for better control in UI components\n            addToBalance,\n            subtractFromBalance,\n            paymentMethods,\n            setPaymentMethods,\n            addPaymentMethod,\n            removePaymentMethod,\n            setDefaultPaymentMethod,\n            updateUser,\n            notificationSettings,\n            updateNotificationSettings,\n            stats,\n            savedLocations,\n            addLocation,\n            removeLocation\n        }}>\n            {children}\n        </UserContext.Provider>\n    );\n};\n\nexport const useUser = () => {\n    const context = useContext(UserContext);\n    if (!context) {\n        throw new Error('useUser must be used within a UserProvider');\n    }\n    return context;\n};\n","usedDeprecatedRules":[]}]
