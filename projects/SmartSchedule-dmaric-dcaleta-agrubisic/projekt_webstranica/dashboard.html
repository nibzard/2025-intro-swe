<<<<<<< HEAD
<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <title>SmartSchedule – Dashboard</title>
    <link rel="stylesheet" href="global.css">
</head>

<body>

<!-- TOP NAVIGATION -->
<div class="topnav">
    <div class="logo-box">
        <div class="logo-icon">SS</div>
        <div class="logo-text">SmartSchedule</div>
    </div>

    <div class="nav-links">
        <a href="index.html">Početna</a>
        <a href="dashboard.html">Dashboard</a>
    </div>
</div>

<div class="container">

    <h1 class="center">Dobrodošli u vaš Dashboard</h1>
    <p class="center" style="color:var(--text-soft); margin-top:10px;">
        Odaberite želite li izraditi osobni ili poslovni raspored
    </p>

    <div class="flex" style="margin-top:40px;">

        <!-- OSOBNI BLOK -->
        <div class="card" style="flex:1;">
            <h2>Osobni raspored</h2>
            <p style="color:var(--text-soft); margin-bottom:20px;">
                Kreirajte osobni raspored i pozovite druge da unesu svoje slobodno vrijeme.
            </p>

            <div class="flex">
                <button class="btn" onclick="location.href='personal.html'">Izradi</button>

                <button class="btn-gray" onclick="accessPersonal()">
                    Pristupi
                </button>
            </div>

            <input id="personalAccess" type="text" placeholder="Upišite šifru rasporeda">
        </div>

        <!-- POSLOVNI BLOK -->
        <div class="card" style="flex:1;">
            <h2>Poslovni raspored</h2>
            <p style="color:var(--text-soft); margin-bottom:20px;">
                Kreirajte tjedni raspored radnika i automatski ga optimizirajte uz AI.
            </p>

            <div class="flex">
                <button class="btn" onclick="location.href='business-create.html'">Izradi</button>

                <button class="btn-gray" onclick="accessBusiness()">
                    Pristupi
                </button>
            </div>

            <input id="businessAccess" type="text" placeholder="Upišite šifru poslovnog rasporeda">
        </div>

    </div>

</div>

<script>
function accessPersonal() {
    const code = document.getElementById("personalAccess").value.trim();
    if (code !== "") location.href = "personal.html";
}

function accessBusiness() {
    const code = document.getElementById("businessAccess").value.trim();
    if (code !== "") location.href = "business-final.html";
}
</script>

</body>
</html>
=======
<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <title>SmartSchedule – Dashboard</title>
    <link rel="stylesheet" href="global.css">
</head>

<body>

<!-- TOP NAVIGATION -->
<div class="topnav">
    <div class="logo-box">
        <div class="logo-icon">SS</div>
        <div class="logo-text">SmartSchedule</div>
    </div>

    <div class="nav-links">
        <a href="index.html">Početna</a>
        <a href="dashboard.html">Dashboard</a>
    </div>

    <!-- USER AREA -->
    <div id="userArea" style="position:absolute; right:12px; top:12px;"></div>
</div>

<div class="container">

    <h1 class="center">Dobrodošli u vaš Dashboard</h1>
    <p class="center" style="color:var(--text-soft); margin-top:10px;">
        Odaberite želite li izraditi osobni ili poslovni raspored
    </p>

    <div class="flex" style="margin-top:40px; gap:30px;">
        <!-- POSLOVNI BLOK -->
        <div class="card" style="flex:1;">
            <h2>Poslovni raspored</h2>
            <p style="color:var(--text-soft); margin-bottom:20px;">
                Kreirajte tjedni raspored radnika i automatski ga optimizirajte uz AI.
            </p>

            <div class="flex">
                <button class="btn" onclick="location.href='business-create.html'">Izradi</button>

                <button class="btn-gray" id="accessBusinessBtn">
                    Pristupi
                </button>
            </div>

            <input id="businessAccess" type="text" placeholder="Upišite šifru poslovnog rasporeda">
            <div id="businessAccessMsg" style="color:#c33; margin-top:8px; min-height:18px;"></div>
        </div>

        <!-- MOJI POSLOVNI RASPOREDI (only for bosses) -->
        <div id="mySchedulesCard" class="card" style="width:360px; flex-shrink:0; display:none;">
            <h3>Moji poslovni rasporedi</h3>
            <p style="color:var(--text-soft); margin-top:8px;">Lista rasporeda koje ste napravili</p>
            <div id="mySchedulesList" style="margin-top:12px"></div>

        </div>

    </div>

</div>

<script>
function accessPersonal() {
    const code = document.getElementById("personalAccess").value.trim();
    if (code !== "") location.href = "personal.html";
}

function accessBusiness() {
    const code = document.getElementById("businessAccess").value.trim();
    const msg = document.getElementById('businessAccessMsg');
    msg.innerText = '';
    if (!code) return;
    const schedule = ssSchedules.getScheduleByCode(code);
    if (!schedule) {
        msg.innerText = 'Raspored s tom šifrom ne postoji.';
        return;
    }
    // allow viewing; save current code in session and redirect
    sessionStorage.setItem('ss_current_schedule', schedule.code);
    location.href = `business-final.html?code=${schedule.code}`;
}
</script>

<script src="auth.js"></script>
<script src="schedules.js"></script>
<script>
// require login and personalize
const user = ssAuth.requireAuth();
// personalize heading
const heading = document.querySelector('h1.center');
if (heading) heading.innerText = `Dobrodošli, ${user.name}`;
// show user area
const ua = document.getElementById('userArea');
if (ua) ua.innerHTML = `<span style="color:var(--text-soft); margin-right:10px;">${user.name}</span> <button class="btn-gray" onclick="ssAuth.logout(); location.href='index.html';">Odjava</button>`;

// If user is boss, show a small hint
if (user.isBoss && user.company) {
    const info = document.createElement('p');
    info.style.color = 'var(--text-soft)';
    info.style.marginTop = '8px';
    info.innerText = `Poslodavac: ${user.company.name || ''}`;
    const container = document.querySelector('.container');
    if (container) container.insertBefore(info, container.firstChild.nextSibling);
}

// wire access button
const accessBtn = document.getElementById('accessBusinessBtn');
if (accessBtn) accessBtn.addEventListener('click', accessBusiness);

// show boss schedules
if (user.isBoss) {
    const card = document.getElementById('mySchedulesCard');
    card.style.display = 'block';
    const list = document.getElementById('mySchedulesList');
    const schedules = ssSchedules.getSchedulesByOwner(user.id);
    if (!schedules.length) list.innerHTML = '<div style="color:var(--text-soft)">Nemate spremljenih rasporeda</div>';
    else {
        list.innerHTML = '';
        schedules.forEach(s=>{
            const row = document.createElement('div');
            row.style.display = 'flex';
            row.style.justifyContent = 'space-between';
            row.style.alignItems = 'center';
            row.style.padding = '8px 0';

            const left = document.createElement('div');
            left.innerHTML = `<div style="font-weight:600">${s.code} <span style='color:var(--text-soft); font-weight:400; font-size:12px;'>(${s.status})</span></div><div style="color:var(--text-soft); font-size:12px;">${new Date(s.createdAt).toLocaleString()}</div>`;
            const actions = document.createElement('div');
            actions.style.display = 'flex';
            actions.style.gap = '8px';
            const open = document.createElement('button');
            open.className = 'btn';
            open.innerText = 'Otvori';
            open.onclick = ()=>{
                sessionStorage.setItem('ss_current_schedule', s.code);
                location.href = `business-final.html?code=${s.code}`;
            };
            actions.appendChild(open);

            // quick publish / lock
            const pub = document.createElement('button');
            pub.className = 'btn-gray';
            pub.innerText = s.status === 'published' ? 'Poništi objavu' : 'Objavi';
            pub.onclick = ()=>{
                const target = s.status === 'published' ? 'draft' : 'published';
                const res = ssSchedules.setScheduleStatus(s, target);
                if (res && res.error) return alert(res.error);
                location.reload();
            };
            actions.appendChild(pub);

            const lock = document.createElement('button');
            lock.className = 'btn-danger';
            lock.innerText = 'Zaključaj';
            lock.onclick = ()=>{
                if (!confirm('Jeste li sigurni da želite zaključati?')) return;
                const res = ssSchedules.setScheduleStatus(s, 'locked');
                if (res && res.error) return alert(res.error);
                location.reload();
            };
            actions.appendChild(lock);

            row.appendChild(left);
            row.appendChild(actions);
            list.appendChild(row);
        });
    }
}
</script>

<script>
(function(){
    const user = (window.ssAuth && ssAuth.getCurrentUser) ? ssAuth.getCurrentUser() : null;
    if (!user || !user.isBoss) return;

            location.reload();
        } catch (e) {
            document.getElementById('cs_msg').innerText = 'Greška: ' + e.message;
        }
    });

    loadSettings();
});
</script>

<!-- INFO: AI sastavljanje rasporeda nije dostupno na ovoj stranici -->
<script>
window.addEventListener('DOMContentLoaded', function() {
    // Provjeri postoji li AI gumb ili funkcionalnost
    if (!document.getElementById('aiBtn') && !document.getElementById('ai_local_btn') && !document.getElementById('ai_openai_btn')) {
        const c = document.querySelector('.container') || document.body;
        const d = document.createElement('div');
        d.style.background = 'rgba(255,255,200,0.95)';
        d.style.color = '#7a5a00';
        d.style.padding = '12px';
        d.style.border = '2px solid #e6c200';
        d.style.borderRadius = '8px';
        d.style.marginTop = '10px';
        d.style.fontWeight = 'bold';
        d.innerText = 'AI sastavljanje rasporeda nije dostupno na ovoj stranici. Otvorite poslovni raspored za AI prijedloge.';
        c.insertBefore(d, c.firstChild);
    }
});
</script>
</html>
>>>>>>> 187ad88d5e209059cc273b46e6724c42f6acae42
